/*! Trivial Components | (c) 2015 Yann Massard and others | Apache License, Version 2.0 (https://raw.githubusercontent.com/trivial-components/trivial-components/master/LICENSE) */
!function(e){"use strict";"function"==typeof define&&define.amd?define("trivial-core",["jquery","mustache"],e):"object"==typeof exports?module.exports=e(require("jquery"),require("mustache")):jQuery&&!window.TrivialComponents&&(window.TrivialComponents=e())}(function(){function e(e){return'<div class="tr-tagbox-default-wrapper-template"><div class="tr-tagbox-tag-content">##entryTemplate##</div><div class="tr-tagbox-tag-remove-button"></div></div>'.replace("##entryTemplate##",e)}function t(e){return-1!=[f.shift,f.caps_lock,f.alt,f.ctrl,f.left_window_key,f.right_window_key].indexOf(e.which)}function n(e,t,n){var r=t.charAt(0).toUpperCase()+t.slice(1),i=t.toLowerCase(),a=t.charAt(0).toLocaleLowerCase()+t.slice(1);$.fn[i]=function(t){var r=[];return this.each(function(){var i=$(this).parents("."+n).addBack("."+n);if(i.length>0&&i[0][a])r.push(i[0][a].$);else{var o=new e(this,t);r.push(o.$)}}),$(r)},$.fn[r]=function(t){var r=[];return this.each(function(){var i=$(this).parents("."+n).addBack("."+n);if(i.length>0&&i[0][a])r.push(i[0][a]);else{var o=new e(this,t);r.push(o)}}),1==r.length?r[0]:r}}function r(e,t,n){e=e.firstChild||e,n=n||t;var r=document.createRange();r.setStart(e,t),r.setEnd(e,n);var i=window.getSelection();i.removeAllRanges(),i.addRange(r)}function i(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function a(){var e=[];this.addListener=function(t){e.push(t)},this.removeListener=function(t){var n=e.indexOf(t);-1!=n&&e.splice(n,1)},this.fire=function(){for(var t=0;t<e.length;t++)e[t].apply(e[t],arguments)}}var o='<div class="tr-template-image-2-lines">  <div class="img-wrapper" style="background-image: url({{imageUrl}})"></div>  <div class="content-wrapper editor-area">     <div class="main-line">{{displayValue}}</div>     <div class="additional-info">{{additionalInfo}}</div>  </div></div>',l='<div class="tr-template-round-image-2-lines-color-bubble">  {{#imageUrl}}<div class="img-wrapper" style="background-image: url({{imageUrl}})"></div>{{/imageUrl}}  <div class="content-wrapper editor-area">     <div class="main-line">{{displayValue}}</div>     <div class="additional-info">{{#statusColor}}<span class="status-bubble" style="background-color: {{statusColor}}"></span>{{/statusColor}}{{additionalInfo}}</div>  </div></div>',s='<div class="tr-template-icon-2-lines">  <div class="img-wrapper" style="background-image: url({{imageUrl}})"></div>  <div class="content-wrapper editor-area">     <div class="main-line">{{displayValue}}</div>     <div class="additional-info">{{additionalInfo}}</div>  </div></div>',d='<div class="tr-template-icon-single-line">  <div class="img-wrapper" style="background-image: url({{imageUrl}})"></div>  <div class="content-wrapper editor-area">{{displayValue}}</div></div>',u='<div class="tr-template-single-line">  <div class="content-wrapper editor-area">     <div>{{displayValue}}</div>   </div></div>',c='<div class="tr-template-currency-single-line-short">  <div class="content-wrapper editor-area">     <div>{{#symbol}}<span class="currency-symbol">{{symbol}}</span>{{/symbol}} {{#code}}<span class="currency-code">{{code}}</span>{{/code}}</div>   </div></div>',p='<div class="tr-template-currency-single-line-long">  <div class="content-wrapper editor-area">     <div class="symbol-and-code">{{#code}}<span class="currency-code">{{code}}</span>{{/code}} {{#symbol}}<span class="currency-symbol">{{symbol}}</span>{{/symbol}}</div>    <div class="currency-name">{{name}}</div>  </div></div>',h='<div class="tr-template-currency-2-lines">  <div class="content-wrapper editor-area">     <div class="main-line">      <span class="currency-code">{{code}}</span>      <span class="currency-name">{{name}}</span>    </div>     <div class="additional-info">      <span class="currency-symbol">{{symbol}}</span>&nbsp;      {{#exchangeRate}}      <div class="exchange">        =         <span class="exchange-rate">{{exchangeRate}}</span>        <span class="exchange-rate-base">{{exchangeRateBase}}</span>      </div>      {{/exchangeRate}}    </div>  </div></div>',f={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,caps_lock:20,escape:27,page_up:33,page_down:34,end:35,home:36,left_arrow:37,up_arrow:38,right_arrow:39,down_arrow:40,insert:45,"delete":46,left_window_key:91,right_window_key:92,select_key:93,num_lock:144,scroll_lock:145,specialKeys:[8,9,13,16,17,18,19,20,27,33,34,35,36,37,38,39,40,45,46,91,92,93,144,145],numberKeys:[48,49,50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,104,105]},y=function(e,t){function n(n){for(var r=[],i=0;i<e.length;i++){var a=e[i],o=a._trEntryElement;(!n||$.trivialMatch(o.text().trim().replace(/\s{2,}/g," "),n,t).length>0)&&r.push(a)}return r}return function(e,t){t(n(e))}},g=function(e,t,n,r){function i(e){var t=function(){};return t.prototype=e,new t}function a(e,t){var l=i(e);if(l[n]=[],l[r]=!1,e[n])for(var s=0;s<e[n].length;s++){var d=e[n][s],u=a(d,t);u&&(l[n].push(u),l[r]=!0)}var c=l[n].length>0,p=o(e,t);return p&&!c&&(l[n]=e[n]),p||c?l:null}function o(e,n){return n?void 0!==e._entryText?$.trivialMatch(e._entryText,n,t).length>0:$.trivialMatch($entryElement.text().trim().replace(/\s{2,}/g," "),n,t).length>0:!0}return function(t,n){if(t){for(var r=[],i=0;i<e.length;i++){var o=e[i],l=a(o,t);l&&r.push(l)}n(r)}else n(e)}};return{image2LinesTemplate:o,roundImage2LinesColorBubbleTemplate:l,icon2LinesTemplate:s,iconSingleLineTemplate:d,singleLineTemplate:u,currencySingleLineShortTemplate:c,currencySingleLineLongTemplate:p,currency2LineTemplate:h,defaultSpinnerTemplate:'<div class="tr-default-spinner"><div class="spinner"></div><div>Fetching data...</div></div>',defaultNoEntriesTemplate:'<div class="tr-default-no-data-display"><div>No matching entries...</div></div>',wrapEntryTemplateWithDefaultTagWrapperTemplate:e,keyCodes:f,defaultListQueryFunctionFactory:y,defaultTreeQueryFunctionFactory:g,isModifierKey:t,registerJqueryPlugin:n,selectElementContents:r,escapeSpecialRegexCharacter:i,Event:a}}),function(e){"use strict";"function"==typeof define&&define.amd?define("trivial-calendarbox",["trivial-core","jquery","mustache"],e):"object"==typeof exports?module.exports=e(require("trivial-core"),require("jquery"),require("mustache")):jQuery&&!jQuery.fn.trivialcalendarbox&&e(TrivialComponents,jQuery,Mustache)}(function(e,t,n){function r(e,n){function r(e,t){for(var n=e.clone().utc().startOf("month").hour(12),r=n.clone().isoWeekday(t<=n.isoWeekday()?t:t-7),i=[],a=r.clone();i.length<42;a.add(1,"day"))i.push(a.clone());return i}function i(e){C.text(e.year()),P.text(moment.months()[e.month()]),b.remove(),b=t('<div class="month-table">').appendTo(w);for(var n=r(e,1),i=t("<tr>").appendTo(b),a=0;7>a;a++)i.append("<th>"+moment.weekdaysMin()[(g.firstDayOfWeek+a)%7]+"</th>");for(var o=0;o<n.length/7;o++){i=t("<tr>").appendTo(b);for(var l=0;7>l;l++){var s=n[7*o+l],d=t("<td>"+s.date()+"</td>");s.month()==e.month()?d.addClass("current-month"):d.addClass("other-month"),s.year()==moment().year()&&s.dayOfYear()==moment().dayOfYear()&&d.addClass("today"),s.year()==v.year()&&s.dayOfYear()==v.dayOfYear()&&(d.addClass("selected"),"day"===m&&d.addClass("keyboard-nav")),d.click(function(e){return function(){f("day"),u(e.month()+1,e.date())}}(s)),i.append(d)}}}function a(e){k.text(e.hour()>=12?"pm":"am");var t=6*e.minute(),n=e.hour()%12+e.minute()/60,r=30*n;_.attr("transform","rotate("+r+",50,50)"),q.attr("transform","rotate("+t+",50,50)"),O.text(e.format("HH")),F.text(e.format("mm"))}function o(e){v=e,L(),h()}function l(e){v.year(e),L(),h()}function s(e){v.month(e-1),L(),h()}function d(e){v.date(e),L(),h()}function u(e,t){v.month(e-1),v.date(t),L(),h()}function c(e){v.hour(e),L(),h()}function p(e){v.minute(e),L(),h()}function h(){x.trigger("change")}function f(e){m=e,t(T).add(E).add(b.find("td.keyboard-nav")).add(_).add(M).add(q).add(j).each(function(){t(this).attr("class",t(this).attr("class").replace("keyboard-nav",""))}),"year"==m?T.addClass("keyboard-nav"):"month"==m?E.addClass("keyboard-nav"):"day"==m?b.find(".selected").addClass("keyboard-nav"):"hour"==m?(_.attr("class","hourhand keyboard-nav"),M.addClass("keyboard-nav")):"minute"==m&&(q.attr("class","minutehand keyboard-nav"),j.addClass("keyboard-nav"))}function y(e,t){return"year"==e?("down"==t||"left"==t?l(v.year()-1):("up"==t||"right"==t)&&l(v.year()+1),!0):"month"==e?("down"==t||"left"==t?s(v.month()):("up"==t||"right"==t)&&s(v.month()+2),!0):"day"==e?("down"==t?v.dayOfYear(v.dayOfYear()+7):"left"==t?v.dayOfYear(v.dayOfYear()-1):"up"==t?v.dayOfYear(v.dayOfYear()-7):"right"==t&&v.dayOfYear(v.dayOfYear()+1),L(),h(),!0):"hour"==e?("down"==t||"left"==t?c(v.hour()-1):("up"==t||"right"==t)&&c(v.hour()+1),!0):"minute"==e?("down"==t||"left"==t?p(v.minute()-v.minute()%5-5):("up"==t||"right"==t)&&p(v.minute()-v.minute()%5+5),!0):void 0}n=n||{};var g=t.extend({selectedDate:null,firstDayOfWeek:1,mode:"datetime"},n),m="time"==g.mode?"hour":"day",v=g.selectedDate,x=t('<div class="tr-calendarbox"/>').appendTo(e),w=t('<div class="tr-calendar-display"/>').appendTo(x),T=t('<div class="year"><span class="back-button"/><span class="name"/><span class="forward-button"/></div>').appendTo(w),E=t('<div class="month"><span class="back-button"/><span class="name"/><span class="forward-button"/></div>').appendTo(w),b=t('<div class="month-table">').appendTo(w),C=T.find(".name"),P=E.find(".name");T.click(f.bind(this,"year")),T.find(".back-button").click(y.bind(this,"year","left")),T.find(".forward-button").click(y.bind(this,"year","right")),E.click(f.bind(this,"month")),E.find(".back-button").click(y.bind(this,"month","left")),E.find(".forward-button").click(y.bind(this,"month","right"));var S=t('<div class="tr-clock-display"/>').appendTo(x).append('<svg class="clock" viewBox="0 0 100 100" width="100" height="100"> <circle class="clockcircle" cx="50" cy="50" r="45"/> <g class="ticks" > <line x1="50" y1="5.000" x2="50.00" y2="10.00"/> <line x1="72.50" y1="11.03" x2="70.00" y2="15.36"/> <line x1="88.97" y1="27.50" x2="84.64" y2="30.00"/> <line x1="95.00" y1="50.00" x2="90.00" y2="50.00"/> <line x1="88.97" y1="72.50" x2="84.64" y2="70.00"/> <line x1="72.50" y1="88.97" x2="70.00" y2="84.64"/> <line x1="50.00" y1="95.00" x2="50.00" y2="90.00"/> <line x1="27.50" y1="88.97" x2="30.00" y2="84.64"/> <line x1="11.03" y1="72.50" x2="15.36" y2="70.00"/> <line x1="5.000" y1="50.00" x2="10.00" y2="50.00"/> <line x1="11.03" y1="27.50" x2="15.36" y2="30.00"/> <line x1="27.50" y1="11.03" x2="30.00" y2="15.36"/> </g> <g class="numbers"> <text x="50" y="22">12</text> <text x="85" y="55">3</text> <text x="50" y="88">6</text> <text x="15" y="55">9</text> </g> <g class="hands"> <line class="minutehand" x1="50" y1="50" x2="50" y2="20"/> <line class="hourhand" x1="50" y1="50" x2="50" y2="26"/> </g> <g class="am-pm-box"><rect x="58" y="59" width="20" height="15"/><text class="amPmText" x="60" y="70" >??</text></g></svg>').append('<div class="digital-time-display"><div class="hour-wrapper"><div class="up-button"/><div class="hour">??</div><div class="down-button"/></div>:<div class="minute-wrapper"><div class="up-button"/><div class="minute">??</div><div class="down-button"/></div></div>'),_=S.find(".hourhand"),q=S.find(".minutehand"),k=S.find(".amPmText"),M=S.find(".digital-time-display .hour-wrapper"),O=S.find(".digital-time-display .hour");M.click(f.bind(this,"hour")),M.find(".up-button").click(y.bind(this,"hour","up")),M.find(".down-button").click(y.bind(this,"hour","down"));var j=S.find(".digital-time-display .minute-wrapper"),F=S.find(".digital-time-display .minute");j.click(f.bind(this,"minute")),j.find(".up-button").click(y.bind(this,"minute","up")),j.find(".down-button").click(y.bind(this,"minute","down")),v?(i(v),a(v)):(i(moment()),a(moment()));var L=function(){i(v),a(v)};this.$=x,this.setSelectedDate=o,this.getSelectedDate=function(){return v},this.setYear=l,this.setMonth=s,this.setDayOfMonth=d,this.setHour=c,this.setMinute=p,this.setKeyboardNavigationState=f,this.navigate=function(e){y(m,e)}}return e.registerJqueryPlugin(r,"TrivialCalendarBox","tr-calendarbox"),t.fn.TrivialCalendarBox}),function(e){"use strict";"function"==typeof define&&define.amd?define("trivial-calendarcombobox",["trivial-core","jquery","mustache"],e):"object"==typeof exports?module.exports=e(require("trivial-core"),require("jquery"),require("mustache")):jQuery&&!jQuery.fn.trivialcalendarcombobox&&e(TrivialComponents,jQuery,Mustache)}(function(e,t,n){function r(n,r){function a(){p&&(T.text(o(p.date(),2)),E.text(o(p.month()+1,2)),b.text(p.year()),C.text(o(p.hour(),2)),P.text(o(p.minute(),2)))}function o(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n}function l(){m.addClass("open"),x.show().position({my:"left top",at:"left bottom",of:m,collision:"flip",using:function(e,n){"top"===n.vertical?(m.removeClass("dropdown-flipped"),t(this).removeClass("flipped")):(m.addClass("dropdown-flipped"),t(this).addClass("flipped")),t(this).css({left:e.left+"px",top:e.top+"px"})}}).width(m.width()),c=!0}function s(){m.removeClass("open"),x.hide(),c=!1}r=r||{};var d,u=t.extend({selectedDate:null,firstDayOfWeek:1,showTrigger:!0},r),c=!1,p=(u.entries,null),h=null,f=!1,y=!1,g=t(n),m=t('<div class="tr-calendarcombobox tr-input-wrapper"/>').insertAfter(g);if(u.showTrigger){var v=t('<div class="tr-trigger"><span class="tr-trigger-icon"/></div>').appendTo(m);v.mousedown(function(){return c?s():(-1==_.get().indexOf(document.activeElement)&&_.first().focus(),l()),!1})}var x=t('<div class="tr-calendarcombobox-dropdown tr-dropdown"></div>').appendTo("body"),w=t('<div class="tr-formatted-field"></div>'),T=t('<span class="dayInput tr-formatted-input-section tr-2-chars right" contenteditable="true" data-maxlength="2" data-placeholder="TT"></span>').appendTo(w);w.append('<span class="separator">.</span>');var E=t('<span class="monthInput tr-formatted-input-section tr-2-chars right" contenteditable="true" data-maxlength="2" data-placeholder="MM"></span>').appendTo(w);w.append('<span class="separator">.</span>');var b=t('<span class="yearInput tr-formatted-input-section tr-4-chars right" contenteditable="true" data-maxlength="4" data-placeholder="JJJJ"></span>').appendTo(w);w.append('<span class="separator"> &nbsp;&nbsp; </span>');var C=t('<span class="hourInput tr-formatted-input-section tr-2-chars right" contenteditable="true" data-maxlength="2" data-placeholder="ss"></span>').appendTo(w);w.append('<span class="separator">:</span>');var P=t('<span class="minuteInput tr-formatted-input-section tr-2-chars right" contenteditable="true" data-maxlength="2" data-placeholder="mm"></span>').appendTo(w);w.append('<span class="separator"> &nbsp;&nbsp; </span>');var S=t('<span class="timeZoneInput tr-formatted-input-section tr-3-chars right" contenteditable="true" data-maxlength="3" data-placeholder="ZZ">CET</span>').appendTo(w),_=w.find("[contenteditable='true']");_.not(_.first()).attr("tabindex","-1"),w.find(".tr-formatted-input-section").on("keydown",function(e){var n=t(this),r=-1!=i.specialKeys.indexOf(e.which),a=n.text().length>=parseInt(n.attr("data-maxlength")),o=window.getSelection().anchorOffset===window.getSelection().focusOffset;!r&&a&&o&&e.preventDefault()}),g.addClass("tr-original-input"),_.focus(function(e){e.target==b[0]?d.setKeyboardNavigationState("year"):e.target==E[0]?d.setKeyboardNavigationState("month"):e.target==T[0]?d.setKeyboardNavigationState("day"):e.target==C[0]?d.setKeyboardNavigationState("hour"):e.target==P[0]?d.setKeyboardNavigationState("minute"):e.target==S[0]&&d.setKeyboardNavigationState("timeZone"),m.addClass("focus")}).blur(function(e){f||(h?t(e.target).focus():(m.removeClass("focus"),s()))}).keydown(function(n){if(n.which!=i.tab&&!e.isModifierKey(n)){if((n.which==i.backspace||n.which==i["delete"])&&(y=!0),n.which==i.up_arrow)return l(),n.target==T[0]?d.navigate("right"):d.navigate("up"),e.selectElementContents(n.target,0,t(n.target).text().length),!1;if(n.which==i.down_arrow)return l(),n.target==T[0]?d.navigate("left"):d.navigate("down"),e.selectElementContents(n.target,0,t(n.target).text().length),!1;if(n.which==i.left_arrow){var r=_.get().indexOf(n.target);if(0!=r&&0==window.getSelection().anchorOffset){var a=_.eq(r-1);return f=!0,a.focus(),e.selectElementContents(a[0],a.text().length),!1}}else if(n.which==i.right_arrow){var r=_.get().indexOf(n.target);if(r!=_.length-1&&window.getSelection().anchorOffset==t(n.target).text().length){var a=_.eq(_.get().indexOf(n.target)+1);return f=!0,a.focus(),!1}}else c&&n.which==i.enter?(s(),w.select()):n.which==i.escape?(s(),clearEditorIfNotContainsFreeText()):l()}}),w.prependTo(m).mousedown(function(e){return l(),-1==_.get().indexOf(e.target)?-1!=_.get().indexOf(document.activeElement)?!1:(_.first().focus(),!1):void 0}),g.attr("placeholder")&&w.attr("placeholder",g.attr("placeholder")),g.attr("tabindex")&&_.first().attr("tabindex",g.attr("tabindex")),g.attr("autofocus")&&_.first().focus(),m.add(x).add(v).mousedown(function(e){m.is(".focus")&&(-1!=_.get().indexOf(document.activeElement)?f=!0:h=!0)}).on("mouseout mouseup",function(){(h||f)&&(h=!1,f=!1)}),d=x.TrivialCalendarBox(u),d.$.change(function(){var e=d.getSelectedDate();e&&(p=e,a())}),d.setSelectedDate(u.selectedDate||null),this.$=m,m[0].trivialCalendarComboBox=this}var i=e.keyCodes;return e.registerJqueryPlugin(r,"TrivialCalendarComboBox","tr-calendarcombobox"),t.fn.TrivialCalendarComboBox}),function(e){"use strict";"function"==typeof define&&define.amd?define("trivial-combobox",["trivial-core","jquery","mustache"],e):"object"==typeof exports?module.exports=e(require("trivial-core"),require("jquery"),require("mustache")):jQuery&&!jQuery.fn.trivialcombobox&&e(TrivialComponents,jQuery,Mustache)}(function(e,t,n){function r(r,a){function o(e){var n=t(w.spinnerTemplate).appendTo(F);q=q.add(n),setTimeout(function(){w.queryFunction(N.val(),function(t){v(t,e)})})}function l(e){k.triggerHandler("change"),x.onSelectedEntryChanged.fire(e)}function s(e,r){if(null==e){w.valueProperty&&k.val(""),C=null;var i=t(n.render(w.selectedEntryTemplate,w.emptyEntry)).addClass("tr-combobox-entry").addClass("empty");O.empty().append(i)}else{w.valueProperty&&k.val(e[w.valueProperty]),C=e;var i=t(n.render(w.selectedEntryTemplate,e)).addClass("tr-combobox-entry");O.empty().append(i),N.val(e[w.inputTextProperty])}r||l(e)}function d(){return null!=C&&C!==w.emptyEntry}function u(){var e=O.find(".editor-area");N.css({width:e.width()+"px",height:e.height()+"px"}).position({my:"left top",at:"left top",of:e})}function c(){w.allowFreeText||d()||!(k.val().length>0||N.val().length>0)||(k.val(""),N.val(""),b=null,l(null))}function p(){w.allowFreeText&&N.val().length>0&&!d()||h()}function h(){N.width(0).height(0)}function f(){L&&(M.addClass("open"),Q(),E=!0)}function y(){M.removeClass("open"),F.hide(),E=!1}function g(){return N.val().substring(0,N[0].selectionStart)}function m(e){if(w.autoComplete){clearTimeout(S);var t=T.getHighlightedEntry();if(t&&!_){var n=t[w.inputTextProperty];S=setTimeout(function(){var e,t=g();e=0===n.toLowerCase().indexOf(t.toLowerCase())?t+n.substr(t.length):g(),N.val(e),setTimeout(function(){N[0].setSelectionRange(t.length,e.length)},0)},e||0)}_=!1}}function v(e,n){n=void 0===n?1:n,b=e,q.remove(),q=t(),T.updateEntries(e);var r=g();r.length>0&&e.length<=w.textHighlightingEntryLimit?(T.highlightTextMatches(r),T.highlightNextMatchingEntry(n)):T.highlightNextEntry(n),m(w.autoCompleteDelay),E&&f()}var x=this;a=a||{};var w=t.extend({valueProperty:null,inputTextProperty:"displayValue",template:e.image2LinesTemplate,selectedEntryTemplate:a.template||e.image2LinesTemplate,selectedEntry:void 0,spinnerTemplate:e.defaultSpinnerTemplate,noEntriesTemplate:e.defaultNoEntriesTemplate,textHighlightingEntryLimit:100,entries:null,emptyEntry:{},queryFunction:null,autoComplete:!0,autoCompleteDelay:0,allowFreeText:!1,freeTextEntryValues:{_isFreeTextEntry:!0},showTrigger:!0,matchingOptions:{matchingMode:"contains",ignoreCase:!0,maxLevenshteinDistance:2},editingMode:"editable"},a);w.queryFunction=w.queryFunction||e.defaultListQueryFunctionFactory(w.entries||[],w.matchingOptions),this.onSelectedEntryChanged=new e.Event;var T,E=!1,b=w.entries,C=null,P=!1,S=-1,_=!1,q=t(),k=t(r),M=t('<div class="tr-combobox tr-input-wrapper"/>').addClass(w.editingMode).insertAfter(k),O=t('<div class="tr-combobox-selected-entry-wrapper"/>').appendTo(M);if(w.showTrigger){var j=t('<div class="tr-trigger"><span class="tr-trigger-icon"/></div>').appendTo(M);j.mousedown(function(){E?(u(),y()):setTimeout(function(){u(),N.select(),f(),null==b&&o()})})}var F=t('<div class="tr-dropdown"></div>').scroll(function(e){return!1}),L="editable"==w.editingMode&&(w.entries&&w.entries.length>0||a.queryFunction||w.showTrigger);L&&F.appendTo("body");var N;w.valueProperty?(k.addClass("tr-original-input"),N=t('<input type="text"/>')):N=k,N.prependTo(M).addClass("tr-combobox-editor tr-editor").focus(function(){P||M.addClass("focus")}).blur(function(){P?N.focus():(M.removeClass("focus"),c(),p(),y(),l(x.getSelectedEntry()))}).keydown(function(t){if(t.which!=i.tab&&!e.isModifierKey(t)){if(t.which==i.left_arrow||t.which==i.right_arrow)return void u();if((t.which==i.backspace||t.which==i["delete"])&&(_=!0),t.which==i.up_arrow||t.which==i.down_arrow){u(),f();var n=t.which==i.up_arrow?-1:1;if(null!=b)return T.highlightNextEntry(n),m(w.autoCompleteDelay),!1;o(n)}else E&&t.which==i.enter?(s(T.getHighlightedEntry()),y(),p(),N.select()):t.which==i.escape?(y(),c(),p()):(u(),f(),o(1))}}).keyup(function(t){!e.isModifierKey(t)&&t.which!=i.enter&&d()&&N.val()!==C[w.inputTextProperty]?s(null):t.which==i.tab&&u()}).mousedown(function(){f(),null==b&&o()}),k.attr("tabindex")&&N.attr("tabindex",k.attr("tabindex")),k.attr("autofocus")&&N.focus(),M.add(F).mousedown(function(){N.is(":focus")&&(P=!0)}).mouseup(function(){P&&(N.focus(),P=!1)}).mouseout(function(){P&&(N.focus(),P=!1)}),T=F.TrivialListBox(w),T.$.change(function(){var e=T.getSelectedEntry();e&&(s(e),T.selectEntry(null),y()),p()}),s(w.selectedEntry||null,!0),O.click(function(){u(),N.select(),f(),null==b&&o()});var Q=function(){F.show().position({my:"left top",at:"left bottom",of:M,collision:"flip",using:function(e,n){"top"===n.vertical?(M.removeClass("dropdown-flipped"),t(this).removeClass("flipped")):(M.addClass("dropdown-flipped"),t(this).addClass("flipped")),t(this).css({left:e.left+"px",top:e.top+"px"})}}).width(M.width())};this.$=M,M[0].trivialComboBox=this,this.updateEntries=v,this.getSelectedEntry=function(){if(null!=C||w.allowFreeText&&N.val()){if(null==C&&w.allowFreeText){var e=t.extend({},w.freeTextEntryValues);return e[w.inputTextProperty]=N.val(),e}var n=jQuery.extend({},C);return n._trEntryElement=void 0,n}return null},this.selectEntry=s}var i=e.keyCodes;return e.registerJqueryPlugin(r,"TrivialComboBox","tr-combobox"),t.fn.TrivialComboBox}),function(e){e.expr[":"].containsIgnoreCase=e.expr.createPseudo(function(t){return function(n){return e(n).text().toUpperCase().indexOf(t.toUpperCase())>=0}})}(jQuery),function(e){e.trivialMatch=function(t,n,r){function i(e){for(var n,r=[];n=e.exec(t);)r.push({start:n.index,length:n[0].length});return r}function a(e,t){var n=new Levenshtein(e,t);return n.distance<=r.maxLevenshteinDistance?[{start:0,length:t.length,distance:n.distance}]:[]}if(!n)throw"searchString may not be empty!";var r=e.extend({matchingMode:"contains",ignoreCase:!0,maxLevenshteinDistance:3},r||null);if(r.ignoreCase&&(t=t.toLowerCase(),n=n.toLowerCase()),"contains"==r.matchingMode)return n=n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),i(new RegExp(n,"g"));if("prefix"==r.matchingMode)return n=n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),i(new RegExp("^"+n,"g"));if("prefix-word"==r.matchingMode)return n=n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),i(n.charAt(0).match(/^\w/)?new RegExp("\\b"+n,"g"):new RegExp(n,"g"));if("prefix-levenshtein"==r.matchingMode)return a(t.substr(0,Math.min(n.length,t.length)),n);if("levenshtein"==r.matchingMode)return a(t,n);throw"unknown matchingMode: "+r.matchingMode}}(jQuery),function(e){e.fn.trivialHighlight=function(t,n){return n=e.extend({highlightClassName:"tr-highlighted-text",matchingMode:"contains",ignoreCase:!0,maxLevenshteinDistance:3},n),this.find("*").each(function(){var r=e(this);r.find("."+n.highlightClassName).contents().unwrap(),this.normalize(),t&&""!==t&&r.contents().filter(function(){return 3==this.nodeType&&e.trivialMatch(this.nodeValue,t,n).length>0}).replaceWith(function(){for(var r=this.nodeValue||"",i="",a=e.trivialMatch(this.nodeValue,t,n),o=0,l=0;l<a.length;l++){var s=a[l];i+=this.nodeValue.substring(o,s.start),i+='<span class="'+n.highlightClassName+'">'+r.substr(s.start,s.length)+"</span>",o=s.start+s.length}return i+=r.substring(o,r.length)})})}}(jQuery),function(e){"use strict";"function"==typeof define&&define.amd?define("trivial-list",["trivial-core","jquery","mustache"],e):"object"==typeof exports?module.exports=e(require("trivial-core"),require("jquery"),require("mustache")):jQuery&&!jQuery.fn.triviallist&&e(TrivialComponents,jQuery,Mustache)}(function(e,t,n){function r(r,a){function o(e){var t=m.filter(function(t){return t[y.valueProperty]==e});return t&&t.length>0?t[0]:null}function l(e){if(E.empty(),e.length>0)for(var r=0;r<e.length;r++){var i=e[r],a=n.render(y.template,i),o=t(a).addClass("tr-list-entry filterable-item").appendTo(E);i._trEntryElement=o,function(e){o.mousedown(function(){x=!0,c(e),b.select()}).mouseup(function(){x&&(b.focus(),x=!1)}).mouseout(function(){x&&(b.focus(),x=!1)}).mouseover(function(){u(e)})}(i)}else E.append(y.noEntriesTemplate)}function s(e,t){v=null,m=e,l(m),m.length>0?(f(),"undefined"!=typeof t&&p(t)):u(null)}function d(e){E.append(y.spinnerTemplate),setTimeout(function(){y.queryFunction(b.val(),function(t){s(t,e)})})}function u(e){v=e,E.find(".tr-list-entry").removeClass("tr-highlighted-entry"),null!=e&&(e._trEntryElement.addClass("tr-highlighted-entry"),E.minimallyScrollTo(e._trEntryElement))}function c(e){E.find(".tr-selected-entry").removeClass("tr-selected-entry"),null==e?w.val(""):(w.val(e[y.valueProperty]),g=e,g._trEntryElement.addClass("tr-selected-entry"))}function p(e){var t=h(e);null!=t&&u(t)}function h(e){var t;if(null==m||0==m.length)return null;if(null==v&&e>0)t=-1+e;else if(null==v&&0>e)t=m.length+e;else{var n=m.indexOf(v);t=(n+m.length+e)%m.length}return m[t]}function f(){for(var e=0;e<m.length;e++){var t=m[e]._trEntryElement;t.trivialHighlight(b.val(),y.matchingOptions)}}a=a||{};var y=t.extend({valueProperty:null,template:e.image2LinesTemplate,spinnerTemplate:e.defaultSpinnerTemplate,noEntriesTemplate:e.defaultNoEntriesTemplate,entries:null,selectedEntryId:null,queryFunction:null,matchingOptions:{matchingMode:"contains",ignoreCase:!0,maxLevenshteinDistance:2}},a);y.queryFunction=y.queryFunction||e.defaultListQueryFunctionFactory(y.entries||[],y.matchingOptions);var g,m=y.entries,v=null,x=!1,w=t(r).addClass("tr-original-input"),T=t('<div class="tr-list"/>').insertAfter(w),E=t('<div class="tr-list-entryList"></div>').appendTo(T),b=t('<input type="text" class="tr-list-editor tr-editor"/>').prependTo(T).focus(function(){T.addClass("focus")}).blur(function(){x?b.focus():(T.removeClass("focus"),u(null))}).keydown(function(t){if(t.which!=i.tab&&!e.isModifierKey(t)&&t.which!=i.left_arrow&&t.which!=i.right_arrow)if(t.which==i.up_arrow||t.which==i.down_arrow){var n=t.which==i.up_arrow?-1:1;if(null!=m)return p(n),!1;d(n)}else t.which==i.enter?(c(v),b.select()):t.which==i.escape?u(null):d(1)}).keyup(function(e){}).mousedown(function(){null==m&&d()});T.add(E).mousedown(function(){b.is(":focus")&&(x=!0)}).mouseup(function(){x&&(b.focus(),x=!1)}).mouseout(function(){x&&(b.focus(),x=!1)}),E.mouseout(function(){u(null)}),m&&l(m),c(y.selectedEntryId?o(y.selectedEntryId):null),this.$=T,T[0].trivialList=this,this.updateEntries=s,this.getSelectedEntry=function(){return g}}var i=e.keyCodes;return e.registerJqueryPlugin(r,"TrivialList","tr-list"),t.fn.TrivialList}),function(e){"use strict";"function"==typeof define&&define.amd?define("trivial-listbox",["trivial-core","jquery","mustache"],e):"object"==typeof exports?module.exports=e(require("trivial-core"),require("jquery"),require("mustache")):jQuery&&!jQuery.fn.triviallistbox&&e(TrivialComponents,jQuery,Mustache)}(function(e,t,n){function r(r,i){function a(e){if(x.empty(),e.length>0)for(var r=0;r<e.length;r++){var i,a=e[r];if(a._trEntryElement)i=a._trEntryElement;else{var o=n.render(y.template,a);i=t(o).addClass("tr-listbox-entry filterable-item")}i.appendTo(x),a._trEntryElement=i,function(e){i.mousedown(function(t){v.trigger("mousedown",t),u(e)}).mouseup(function(e){v.trigger("mouseup",e)}).mouseenter(function(){s(e)}).mouseleave(function(e){t(e.toElement).is(".tr-listbox-entry")||s(null)})}(a)}else x.append(y.noEntriesTemplate)}function o(e,t){m=null,g=e,a(g),g.length>0?"undefined"!=typeof t&&c(t):s(null)}function l(e){v.parent().minimallyScrollTo(e)}function s(e){e!==m&&(m=e,x.find(".tr-listbox-entry").removeClass("tr-highlighted-entry"),null!=e&&(e._trEntryElement.addClass("tr-highlighted-entry"),l(e._trEntryElement)))}function d(){v.trigger("change")}function u(e){f=e,x.find(".tr-selected-entry").removeClass("tr-selected-entry"),null!=e&&f._trEntryElement.addClass("tr-selected-entry"),d()}function c(e){var t=p(e);null!=t&&s(t)}function p(e){var t;if(null==g||0==g.length)return null;if(null==m&&e>0)t=-1+e;else if(null==m&&0>e)t=g.length+e;else{var n=g.indexOf(m);t=(n+g.length+e)%g.length}return g[t]}function h(e){for(var t=0;t<g.length;t++){var n=g[t]._trEntryElement;n.trivialHighlight(e,y.matchingOptions)}}i=i||{};var f,y=t.extend({template:e.image2LinesTemplate,spinnerTemplate:e.defaultSpinnerTemplate,entries:null,queryFunction:null,textHighlightingEntryLimit:100,matchingOptions:{matchingMode:"contains",ignoreCase:!0,maxLevenshteinDistance:2}},i),g=y.entries,m=null,v=t('<div class="tr-listbox"/>').appendTo(r),x=t('<div class="tr-listbox-entry-list"></div>').appendTo(v);g&&a(g),this.$=v,v[0].trivialListBox=this,this.updateEntries=o,this.getSelectedEntry=function(){if(f){var e=jQuery.extend({},f);return e._trEntryElement=void 0,e}return null},this.selectEntry=u,this.highlightNextEntry=c,this.highlightNextMatchingEntry=function(e){var t=p(e);null!=t&&s(t)},this.getHighlightedEntry=function(){return m},this.highlightTextMatches=h}return e.registerJqueryPlugin(r,"TrivialListBox","tr-listbox"),t.fn.TrivialListBox}),$.fn.minimallyScrollTo=function(e){return this.each(function(){var t=$(this),n=t.scrollTop(),r=n+t.innerHeight(),i=$(e).offset().top-$(this).offset().top+t.scrollTop(),a=i+e.height();n>i?t.scrollTop(i):a>r&&t.scrollTop(Math.min(i,a-t.innerHeight()))})},function(e){"use strict";"function"==typeof define&&define.amd?define("trivial-tagbox",["trivial-core","jquery","mustache"],e):"object"==typeof exports?module.exports=e(require("trivial-core"),require("jquery"),require("mustache")):jQuery&&!jQuery.fn.trivialtagbox&&e(TrivialComponents,jQuery,Mustache)}(function(e,t,n){function r(r,a){function o(e){if(N.empty(),e.length>0)for(var r=0;r<e.length;r++){var i=e[r],a=n.render(b.template,i),o=t(a).addClass("tr-tagbox-entry filterable-item").appendTo(N);i._trEntryElement=o,function(e){o.mousedown(function(){q=!0,h(e),D.select(),g()}).mouseup(function(){q&&(D.focus(),q=!1)}).mouseout(function(){q&&(D.focus(),q=!1)}).mouseover(function(){u(e)})}(i)}else N.append(b.noEntriesTemplate)}function l(e,t){_=null,P=e,o(P),P.length>0?(T(),"undefined"!=typeof t&&x(t)):u(null)}function s(e){var t=S.indexOf(e);t>-1&&S.splice(t,1),e._trEntryElement.remove(),O.val(p()),c(E.getSelectedEntries())}function d(e){N.append(b.spinnerTemplate),setTimeout(function(){b.queryFunction(D.text().replace(String.fromCharCode(160)," "),function(t){l(t,e),C&&y()})})}function u(e){_=e,N.find(".tr-tagbox-entry").removeClass("tr-highlighted-entry"),null!=e&&(e._trEntryElement.addClass("tr-highlighted-entry"),N.minimallyScrollTo(e._trEntryElement))}function c(e){O.trigger("change"),E.onSelectedEntryChanged.fire(e)}function p(){return S.map(function(e){return e[b.valueProperty]}).join(b.valueSeparator)}function h(e,r){
    if(null!=e&&!(b.maxSelectedEntries&&S.length>=b.maxSelectedEntries||b.distinct&&-1!=S.map(function(e){return e[b.valueProperty]}).indexOf(e[b.valueProperty]))){var i=t.extend({},e);S.push(i),O.val(p());var a=t(n.render(b.selectedEntryTemplate,i));a.find(".tr-tagbox-tag-remove-button").click(function(e){return s(i),!1});var o=t('<div class="tr-tagbox-tag"></div>');o.append(a).insertBefore(D),i._trEntryElement=o,D.text(""),r||c(E.getSelectedEntries())}}function f(){N.position({my:"left top",at:"left bottom",of:j,collision:"flip",using:function(e,n){"top"===n.vertical?(j.removeClass("dropdown-flipped"),t(this).removeClass("flipped")):(j.addClass("dropdown-flipped"),t(this).addClass("flipped")),t(this).css({left:e.left+"px",top:e.top+"px"})}}).width(j.width())}function y(){Q&&(j.addClass("open"),N.show(),f(),C=!0)}function g(){j.removeClass("open"),N.hide(),C=!1}function m(){var e=D.text().replace(String.fromCharCode(160)," "),t=window.getSelection();return t.anchorOffset!=t.focusOffset?e.substring(0,Math.min(window.getSelection().baseOffset,window.getSelection().focusOffset)):e}function v(t,n){clearTimeout(k),M||(k=setTimeout(function(){var n,r=m();n=0===t.toLowerCase().indexOf(r.toLowerCase())?r+t.substr(r.length):m(),D.text(n),f(),setTimeout(function(){e.selectElementContents(D[0],r.length,n.length)},0)},n||0)),M=!1}function x(e){var t=w(e);null!=t&&(u(t),b.autoComplete&&v(t[b.inputTextProperty],b.autoCompleteDelay))}function w(e){var t;if(null==P||0==P.length)return null;if(null==_&&e>0)t=-1+e;else if(null==_&&0>e)t=P.length+e;else{var n=P.indexOf(_);t=(n+P.length+e)%P.length}return P[t]}function T(){for(var e=m(),t=0;t<P.length;t++){var n=P[t]._trEntryElement;n.trivialHighlight(e,b.matchingOptions)}}var E=this;a=a||{};var b=t.extend({valueProperty:"displayValue",valueSeparator:",",inputTextProperty:"displayValue",template:e.image2LinesTemplate,selectedEntryTemplate:a.template?e.wrapEntryTemplateWithDefaultTagWrapperTemplate(a.template):e.wrapEntryTemplateWithDefaultTagWrapperTemplate(e.image2LinesTemplate),spinnerTemplate:e.defaultSpinnerTemplate,noEntriesTemplate:e.defaultNoEntriesTemplate,entries:null,selectedEntries:[],maxSelectedEntries:null,queryFunction:null,autoComplete:!0,autoCompleteDelay:0,allowFreeText:!0,freeTextSeparators:[",",";"],freeTextEntryValues:{_isFreeTextEntry:!0},showTrigger:!0,distinct:!0,matchingOptions:{matchingMode:"contains",ignoreCase:!0,maxLevenshteinDistance:2},editingMode:"editable"},a);b.queryFunction=b.queryFunction||e.defaultListQueryFunctionFactory(b.entries||[],b.matchingOptions),this.onSelectedEntryChanged=new e.Event;var C=!1,P=b.entries,S=[],_=null,q=!1,k=-1,M=!1,O=t(r).addClass("tr-original-input"),j=t('<div class="tr-tagbox tr-input-wrapper"/>').addClass(b.editingMode).insertAfter(O);O.appendTo(j);var F=t('<div class="tr-tagbox-tagarea"/>').appendTo(j);if(b.showTrigger){var L=t('<div class="tr-trigger"><span class="tr-trigger-icon"/></div>').appendTo(j);L.mousedown(function(){C?g():setTimeout(function(){D.select(),y(),null==P&&d()})})}var N=t('<div class="tr-dropdown"></div>').scroll(function(e){return!1}),Q="editable"==b.editingMode&&(b.entries&&b.entries.length>0||a.queryFunction||b.showTrigger);Q&&N.appendTo("body");var D=t('<span contenteditable="true" class="tagbox-editor"></span>');D.appendTo(F).addClass("tr-tagbox-editor tr-editor").focus(function(){q||j.addClass("focus")}).blur(function(){if(q)D.focus();else{if(j.removeClass("focus"),P=null,g(),b.allowFreeText&&D.text().trim().length>0){var e=t.extend({},b.freeTextEntryValues);e[b.inputTextProperty]=D.text(),h(e)}D.text("")}}).keydown(function(n){if(n.which!=i.tab&&!e.isModifierKey(n)&&n.which!=i.left_arrow&&n.which!=i.right_arrow)if(n.which!=i.backspace&&n.which!=i["delete"])if(n.which==i.up_arrow||n.which==i.down_arrow){y();var r=n.which==i.up_arrow?-1:1;if(null!=P)return x(r),!1;d(r)}else if(n.which==i.enter){if(C&&null!=_)h(_),P=null;else if(b.allowFreeText&&D.text().trim().length>0){var a=t.extend({},b.freeTextEntryValues);a[b.inputTextProperty]=D.text(),h(a)}g()}else n.which==i.escape?(g(),D.text("")):(y(),d(1));else if(""==D.text()){if(S.length>0){var o=S[S.length-1];s(o),g()}}else M=!0,d(1)}).keyup(function(t){function n(t,n){return t.split(new RegExp("["+e.escapeSpecialRegexCharacter(n.join())+"]"))}if(D.find("*").length>0&&D.text(D.text()),b.allowFreeText){var r=m();if(r.length>0)for(var i=n(r,b.freeTextSeparators),a=0;a<i.length-1;a++){var o=i[a].trim();if(o.length>0){var l={};l[b.inputTextProperty]=o,h(l)}D.text(i[i.length-1]),e.selectElementContents(D[0],D.text().length,D.text().length),P=null,g()}}}).mousedown(function(){y(),null==P&&d()}),O.attr("placeholder")&&D.attr("placeholder",O.attr("placeholder")),O.attr("tabindex")&&D.attr("tabindex",O.attr("tabindex")),O.attr("autofocus")&&D.focus(),j.add(N).mousedown(function(){D.is(":focus")&&(q=!0)}).mouseup(function(){q&&(D.focus(),q=!1)}).mouseout(function(){q&&(D.focus(),q=!1)}),P&&o(P),F.click(function(){D.select(),y(),null==P&&d()});for(var B=0;B<b.selectedEntries.length;B++)h(b.selectedEntries[B],!0);this.$=j,j[0].trivialTagBox=this,this.updateEntries=l,this.getSelectedEntries=function(){for(var e=[],t=0;t<S.length;t++){var n=jQuery.extend({},S[t]);n._trEntryElement=void 0,e.push(n)}return e}}var i=e.keyCodes;return e.registerJqueryPlugin(r,"TrivialTagBox","tr-tagbox"),t.fn.TrivialTagBox}),function(e){"use strict";"function"==typeof define&&define.amd?define("trivial-tree",["trivial-core","jquery","mustache"],e):"object"==typeof exports?module.exports=e(require("trivial-core"),require("jquery"),require("mustache")):jQuery&&!jQuery.fn.Trivialtree&&(window.TrivialTree=e(TrivialComponents,jQuery,Mustache))}(function(e,t,n){function r(n,r){function a(e){m=e,v.remove(),v=t(),y.updateEntries(e)}function o(e){if("always-visible"===f.searchBarMode||"show-if-filled"===f.searchBarMode){var n=t(f.spinnerTemplate).appendTo(T);v=v.add(n),setTimeout(function(){f.queryFunction(E.val(),function(t){function n(){a(t),E.val().length>0&&(y.highlightTextMatches(E.val()),f.directSelectionViaArrowKeys||y.highlightNextMatchingEntry(e)),y.revealSelectedEntry()}clearTimeout(b),l(t)<f.performanceOptimizationSettings.toManyVisibleItemsThreshold?n():b=setTimeout(n,f.performanceOptimizationSettings.toManyVisibleItemsRenderDelay)})},0)}}function l(e){function t(e){return e[f.expandedProperty]&&e[f.childrenProperty]?e[f.childrenProperty].map(function(e){return t(e)}).reduce(function(e,t){return e+t},0)+1:1}return e.map(function(e){return t(e)}).reduce(function(e,t){return e+t},0)}function s(e){function t(n,r){if(e.call(this,n)&&r.push(n),n[f.childrenProperty])for(var i=0;i<n[f.childrenProperty].length;i++){var a=n[f.childrenProperty][i];t(a,r)}}for(var n=[],r=0;r<m.length;r++){var i=m[r];t(i,n)}return n}function d(e){return s(function(t){return t[f.valueProperty]==e})[0]}function u(e){g=e?e[f.valueProperty]:null,x.val(e?e[f.valueProperty]:null),c(e)}function c(e){x.trigger("change"),w.trigger("change"),p.onSelectedEntryChanged.fire(e)}var p=this;r=r||{};var h={valueProperty:"id",childrenProperty:"children",lazyChildrenFlagProperty:"hasLazyChildren",searchBarMode:"show-if-filled",lazyChildrenQueryFunction:function(e,t){t([])},expandedProperty:"expanded",templates:[e.iconSingleLineTemplate],spinnerTemplate:e.defaultSpinnerTemplate,noEntriesTemplate:e.defaultNoEntriesTemplate,entries:null,selectedEntryId:null,matchingOptions:{matchingMode:"contains",ignoreCase:!0,maxLevenshteinDistance:2},directSelectionViaArrowKeys:!1,performanceOptimizationSettings:{toManyVisibleItemsRenderDelay:750,toManyVisibleItemsThreshold:75}},f=t.extend(h,r);f.queryFunction=f.queryFunction||e.defaultTreeQueryFunctionFactory(f.entries||[],f.matchingOptions,f.childrenProperty,f.expandedProperty),this.onSelectedEntryChanged=new e.Event,this.onNodeExpansionStateChanged=new e.Event;var y,g,m=f.entries,v=t(),x=t(n).addClass("tr-original-input"),w=t('<div class="tr-tree" tabindex="0"/>').insertAfter(x);"always-visible"!==f.searchBarMode&&w.addClass(f.showSearchField?"":"hide-searchfield"),w.keydown(function(t){if(t.which!=i.tab&&!e.isModifierKey(t))if(E.is(":visible")&&-1===i.specialKeys.indexOf(t.which)&&E.focus(),t.which==i.up_arrow||t.which==i.down_arrow){var n=t.which==i.up_arrow?-1:1;if(null!=m)return f.directSelectionViaArrowKeys?y.selectNextEntry(n):y.highlightNextEntry(n),!1}else t.which==i.left_arrow||t.which==i.right_arrow?y.setHighlightedNodeExpanded(t.which==i.right_arrow):t.which==i.enter?y.setSelectedEntry(y.getHighlightedEntry()[f.valueProperty]):t.which==i.escape?(E.val(""),o(),w.focus()):o(1)});var T=t('<div class="tr-tree-entryTree"></div>').appendTo(w),E=t('<input type="text" class="tr-tree-editor tr-editor"/>').prependTo(w).attr("tabindex",x.attr("-1")).focus(function(){w.addClass("focus")}).blur(function(){w.removeClass("focus")}).keydown(function(e){if(e.which==i.left_arrow||e.which==i.right_arrow){var t=y.setHighlightedNodeExpanded(e.which==i.right_arrow);return t?!1:void 0}}).on("keyup change",function(){"show-if-filled"===f.searchBarMode&&(E.val()?w.removeClass("hide-searchfield"):w.addClass("hide-searchfield"))});"none"===f.searchBarMode&&E.css("display","none"),x.attr("placeholder")&&E.attr("placeholder",x.attr("placeholder")),x.attr("tabindex")&&w.attr("tabindex",x.attr("tabindex")),x.attr("autofocus")&&w.focus(),y=T.TrivialTreeBox(f),y.onNodeExpansionStateChanged.addListener(function(e){p.onNodeExpansionStateChanged.fire(e)}),y.$.change(function(){var e=y.getSelectedEntry();e&&u(e)}),u(void 0!==f.selectedEntryId&&null!==f.selectedEntryId?d(f.selectedEntryId):null);var b;this.$=w,w[0].trivialTree=this,this.updateEntries=a,this.getSelectedEntry=y.getSelectedEntry,this.updateChildren=y.updateChildren,this.updateNode=y.updateNode,this.removeNode=y.removeNode,this.addNode=y.addNode}var i=e.keyCodes;return e.registerJqueryPlugin(r,"TrivialTree","tr-tree"),t.fn.TrivialTree}),function(e){"use strict";"function"==typeof define&&define.amd?define("trivial-treebox",["trivial-core","jquery","mustache"],e):"object"==typeof exports?module.exports=e(require("trivial-core"),require("jquery"),require("mustache")):jQuery&&!jQuery.fn.TrivialTreeBox&&(window.TrivialTreeBox=e(TrivialComponents,jQuery,Mustache))}(function(e,t,n){function r(r,i){function a(e){return(null==e[k.childrenProperty]||0==e[k.childrenProperty].length)&&!e[k.lazyChildrenFlagProperty]}function o(e,r){return t(n.render(k.templates[Math.min(k.templates.length-1,r)],e))}function l(e,n){var r=a(e),i=t('<div class="tr-tree-entry-outer-wrapper '+(r?"":"has-children")+'" data-depth="'+n+'"></div>');e._trEntryElement=i;for(var s=t('<div class="tr-tree-entry-and-expander-wrapper"></div>').appendTo(i),u=0;n>u;u++)s.append('<div class="tr-indent-spacer"/>');var c=t('<div class="tr-tree-expander"></div>').appendTo(s),p=o(e,n);if(p.addClass("tr-tree-entry filterable-item").appendTo(s),s.mousedown(function(t){F.trigger("mousedown",t),m(e)}).mouseup(function(e){F.trigger("mouseup",e)}).mouseenter(function(){E(e)}).mouseleave(function(e){t(e.toElement).is(".tr-tree-entry-outer-wrapper")||E(null)}),!r){var h=t('<div class="tr-tree-entry-children-wrapper"></div>').appendTo(i);if(c.mousedown(function(e){return!1}).click(function(t){d(e,!e[k.expandedProperty],!0)}),e[k.childrenProperty]){if(e[k.expandedProperty])for(var f=0;f<e[k.childrenProperty].length;f++)l(e[k.childrenProperty][f],n+1).appendTo(h)}else e[k.lazyChildrenFlagProperty]&&h.hide().append(k.spinnerTemplate).fadeIn();d(e,e[k.expandedProperty],!1)}return i}function s(e){if(L.remove(),L=t('<div class="tr-tree-entryTree"></div>'),e.length>0)for(var n=0;n<e.length;n++)l(e[n],0).appendTo(L);else L.append(k.noEntriesTemplate);L.appendTo(F)}function d(e,t,n){function r(e){return e[k.childrenProperty]&&e[k.childrenProperty].some(function(e){return!e._trEntryElement||!jQuery.contains(document.documentElement,e._trEntryElement[0])})}var i=e[k.expandedProperty];e[k.expandedProperty]=!!t,e._trEntryElement.toggleClass("expanded",!!t),t?e._trEntryElement.find("> .tr-tree-entry-children-wrapper").slideDown(n?k.animationDuration:0):e._trEntryElement.find("> .tr-tree-entry-children-wrapper").slideUp(n?k.animationDuration:0),t&&e[k.lazyChildrenFlagProperty]&&!e[k.childrenProperty]?k.lazyChildrenQueryFunction(e,function(t){c(e,t)}):t&&r(e)&&p(e),t&&v(e._trEntryElement),!!i!=!!t&&_.onNodeExpansionStateChanged.fire(e)}function u(e){return e?parseInt(e._trEntryElement.attr("data-depth")):0}function c(e,t){e[k.childrenProperty]=t,e[k.lazyChildrenFlagProperty]=!1,p(e,t)}function p(e){var t=e._trEntryElement.find("> .tr-tree-entry-children-wrapper");t.empty();var n=e[k.childrenProperty];if(n&&n.length>0)for(var r=u(e),i=0;i<n.length;i++){var a=n[i];l(a,r+1).appendTo(t)}else e._trEntryElement.removeClass("has-children expanded")}function h(e,t){j=null,O=e,f(function(e){var t=n.render(k.templates[0],e);e._entryText=t.replace(/<.*?>/g,"").replace(/\s{2,}/g," ")}),s(O);var r=y(M);r&&x(r)}function f(e){function t(n,r){if(e.call(this,n)&&r.push(n),n[k.childrenProperty])for(var i=0;i<n[k.childrenProperty].length;i++){var a=n[k.childrenProperty][i];t(a,r)}}for(var n=[],r=0;r<O.length;r++){var i=O[r];t(i,n)}return n}function y(e){return f(function(t){return t[k.valueProperty]==e})[0]}function g(e){return f(function(t){return t[k.childrenProperty]&&-1!=t[k.childrenProperty].indexOf(e)})[0]}function m(e){M=e?e[k.valueProperty]:null,x(e),E(e),w(e)}function v(e){F.parent().minimallyScrollTo(e)}function x(e){if(L.find(".tr-selected-entry").removeClass("tr-selected-entry"),e){var t=e._trEntryElement.find(">.tr-tree-entry-and-expander-wrapper");t.addClass("tr-selected-entry"),v(t)}}function w(e){F.trigger("change"),_.onSelectedEntryChanged.fire(e)}function T(e){var t=C(S(),e);null!=t&&m(t)}function E(e){if(e!==j)if(j=e,L.find(".tr-highlighted-entry").removeClass("tr-highlighted-entry"),null!=e){var t=e._trEntryElement.find(">.tr-tree-entry-and-expander-wrapper");t.addClass("tr-highlighted-entry"),v(t)}else{var n=S();n&&(j=n)}}function b(e){var t=C(j||S(),e);null!=t&&E(t)}function C(e,t,n){var r,i=f(function(t){return t._trEntryElement?n?t._trEntryElement.is(":visible")&&t._trEntryElement.has(">.tr-tree-entry-and-expander-wrapper .tr-highlighted-text").length>0:t._trEntryElement.is(":visible")||t===e:!1});if(null==i||0==i.length)return null;if(null==e&&t>0)r=-1+t;else if(null==e&&0>t)r=i.length+t;else{var a=i.indexOf(e);r=(a+i.length+t)%i.length}return i[r]}function P(e){L.detach();for(var t=0;t<O.length;t++){var n=O[t],r=n._trEntryElement.find(".tr-tree-entry");r.trivialHighlight(e,k.matchingOptions)}L.appendTo(F)}function S(){return void 0!==M&&null!==M?y(M):null}var _=this;i=i||{};var q={valueProperty:"id",childrenProperty:"children",lazyChildrenFlagProperty:"hasLazyChildren",lazyChildrenQueryFunction:function(e,t){t(e.children||[])},expandedProperty:"expanded",templates:[e.iconSingleLineTemplate],spinnerTemplate:e.defaultSpinnerTemplate,noEntriesTemplate:e.defaultNoEntriesTemplate,entries:null,selectedEntryId:null,matchingOptions:{matchingMode:"contains",ignoreCase:!0,maxLevenshteinDistance:2},animationDuration:70},k=t.extend(q,i);this.onSelectedEntryChanged=new e.Event,this.onNodeExpansionStateChanged=new e.Event;var M,O=k.entries,j=null,F=t('<div class="tr-treebox"/>').appendTo(r),L=t('<div class="tr-tree-entryTree"></div>').appendTo(F);O&&h(O),m(void 0!==k.selectedEntryId&&null!==k.selectedEntryId?y(k.selectedEntryId):null),this.$=F,F[0].trivialTreeBox=this,this.updateEntries=h,this.getSelectedEntry=S,this.setSelectedEntry=function(e){m(y(e))},this.selectNextEntry=T,this.revealSelectedEntry=function(e){var t=S();if(t)for(;t=g(t);)d(t,!0,e)},this.setHighlightedEntry=E,this.highlightNextEntry=b,this.highlightNextMatchingEntry=function(e){var t=C(j,e,!0);null!=t&&E(t)},this.selectNextMatchingEntry=function(e){var t=C(j,e,!0);null!=t&&m(t)},this.getHighlightedEntry=function(){return j},this.highlightTextMatches=P,this.setHighlightedNodeExpanded=function(e){if(!j||a(j))return!1;var t=j[k.expandedProperty];return d(j,e,!0),!t!=!e},this.updateChildren=function(e,t){var n=y(e);n&&c(n,t)},this.updateNode=function(e){var t=y(e.id),n=g(t);n?n[k.childrenProperty][n[k.childrenProperty].indexOf(t)]=e:O[O.indexOf(t)]=e,l(e,u(t)).insertAfter(t._trEntryElement),t._trEntryElement.remove()},this.removeNode=function(e){var t=y(e);if(t){var n=g(t);n?n[k.childrenProperty].splice(n[k.childrenProperty].indexOf(t),1):O.splice(O.indexOf(t),1),t._trEntryElement.remove()}},this.addNode=function(e,t){var n=y(e);a(n),n[k.childrenProperty]||(n[k.childrenProperty]=[]),n[k.childrenProperty].push(t);var r=l(t,u(n)+1);r.appendTo(n._trEntryElement.find(">.tr-tree-entry-children-wrapper")),n._trEntryElement.addClass("has-children")}}return e.registerJqueryPlugin(r,"TrivialTreeBox","tr-treebox"),t.fn.TrivialTreeBox}),function(e){"use strict";"function"==typeof define&&define.amd?define("trivial-treecombobox",["trivial-core","jquery","mustache"],e):"object"==typeof exports?module.exports=e(require("trivial-core"),require("jquery"),require("mustache")):jQuery&&!jQuery.fn.trivialtreecombobox&&e(TrivialComponents,jQuery,Mustache)}(function(e,t,n){function r(r,a){function o(e){var n=t(w.spinnerTemplate).appendTo(F);q=q.add(n),setTimeout(function(){w.queryFunction(N.val(),function(t){v(t,e)})},0)}function l(e){k.triggerHandler("change"),x.onSelectedEntryChanged.fire(e)}function s(e,r){if(null==e){w.valueProperty&&k.val(""),C=null;var i=t(n.render(w.selectedEntryTemplate,w.emptyEntry)).addClass("tr-combobox-entry").addClass("empty");O.empty().append(i)}else{w.valueProperty&&k.val(e[w.valueProperty]),C=e;var i=t(n.render(w.selectedEntryTemplate,e)).addClass("tr-combobox-entry");O.empty().append(i),N.val(e[w.inputTextProperty])}r||l(e)}function d(){return null!=C&&C!==w.emptyEntry}function u(){var e=O.find(".editor-area");N.css({width:e.width()+"px",height:e.height()+"px"}).position({my:"left top",at:"left top",of:e})}function c(){w.allowFreeText||d()||!(k.val().length>0||N.val().length>0)||(k.val(""),N.val(""),b=null,l(null))}function p(){w.allowFreeText&&N.val().length>0&&!d()||h()}function h(){N.width(0).height(0)}function f(){L&&(M.addClass("open"),Q(),E=!0)}function y(){M.removeClass("open"),F.hide(),E=!1}function g(){return N.val().substring(0,N[0].selectionStart)}function m(e){if(w.autoComplete){clearTimeout(S);var t=T.getHighlightedEntry();if(t&&!_){var n=t[w.inputTextProperty];S=setTimeout(function(){var e,t=g();e=0===n.toLowerCase().indexOf(t.toLowerCase())?t+n.substr(t.length):g(),N.val(e),setTimeout(function(){N[0].setSelectionRange(t.length,e.length)},0)},e||0)}_=!1}}function v(e,n){b=e,q.remove(),q=t(),T.updateEntries(e);var r=g();r.length>0?(T.highlightTextMatches(r),T.highlightNextMatchingEntry(n)):T.highlightNextEntry(n),m(w.autoCompleteDelay),E&&f()}var x=this;a=a||{};var w=t.extend({valueProperty:"id",inputTextProperty:"displayValue",templates:[e.iconSingleLineTemplate],selectedEntryTemplate:a.templates&&a.templates.length>0&&a.templates[0]||e.icon2LinesTemplate,selectedEntry:null,spinnerTemplate:e.defaultSpinnerTemplate,noEntriesTemplate:e.defaultNoEntriesTemplate,entries:null,emptyEntry:{},queryFunction:null,autoComplete:!0,autoCompleteDelay:0,allowFreeText:!1,freeTextEntryValues:{_isFreeTextEntry:!0},showTrigger:!0,matchingOptions:{matchingMode:"contains",ignoreCase:!0,maxLevenshteinDistance:2},childrenProperty:"children",lazyChildrenFlagProperty:"hasLazyChildren",expandedProperty:"expanded",editingMode:"editable"},a);w.queryFunction=w.queryFunction||e.defaultTreeQueryFunctionFactory(w.entries||[],w.matchingOptions,w.childrenProperty,w.expandedProperty),this.onSelectedEntryChanged=new e.Event;var T,E=!1,b=w.entries,C=null,P=!1,S=-1,_=!1,q=t(),k=t(r),M=t('<div class="tr-combobox tr-input-wrapper"/>').addClass(w.editingMode).insertAfter(k),O=t('<div class="tr-combobox-selected-entry-wrapper"/>').appendTo(M);if(w.showTrigger){var j=t('<div class="tr-trigger"><span class="tr-trigger-icon"/></div>').appendTo(M);j.mousedown(function(){E?(u(),y()):setTimeout(function(){u(),N.select(),f(),null==b&&o()})})}var F=t('<div class="tr-dropdown"></div>').scroll(function(e){return!1}),L="editable"==w.editingMode&&(w.entries&&w.entries.length>0||a.queryFunction||w.showTrigger);L&&F.appendTo("body");var N;w.valueProperty?(k.addClass("tr-original-input"),N=t('<input type="text"/>')):N=k,N.prependTo(M).addClass("tr-combobox-editor tr-editor").focus(function(){P||M.addClass("focus")}).blur(function(){P?N.focus():(M.removeClass("focus"),c(),p(),y(),l(x.getSelectedEntry()))}).keydown(function(t){if(t.which!=i.tab&&!e.isModifierKey(t)){if(t.which==i.left_arrow||t.which==i.right_arrow){if(E){var n=T.setHighlightedNodeExpanded(t.which==i.right_arrow);if(n)return!1}return void u()}if((t.which==i.backspace||t.which==i["delete"])&&(_=!0),t.which==i.up_arrow||t.which==i.down_arrow){u(),f();var r=t.which==i.up_arrow?-1:1;if(null!=b)return T.highlightNextEntry(r),m(w.autoCompleteDelay),!1;o(r)}else E&&t.which==i.enter?(s(T.getHighlightedEntry()),y(),p(),N.select()):t.which==i.escape?(y(),c(),p()):(u(),f(),o(1))}}).keyup(function(t){!e.isModifierKey(t)&&t.which!=i.enter&&d()&&N.val()!==C[w.inputTextProperty]?s(null):t.which==i.tab&&u()}).mousedown(function(){f(),null==b&&o()}),k.attr("tabindex")&&N.attr("tabindex",k.attr("tabindex")),k.attr("autofocus")&&N.focus(),M.add(F).mousedown(function(){N.is(":focus")&&(P=!0)}).mouseup(function(){P&&(N.focus(),P=!1)}).mouseout(function(){P&&(N.focus(),P=!1)}),T=F.TrivialTreeBox(w),T.$.change(function(){var e=T.getSelectedEntry();e&&(s(e),T.setSelectedEntry(null),y()),p()}),s(T.getSelectedEntry(),!0),O.click(function(){u(),N.select(),f(),null==b&&o()});var Q=function(){F.show().position({my:"left top",at:"left bottom",of:M,collision:"flip",using:function(e,n){"top"===n.vertical?(M.removeClass("dropdown-flipped"),t(this).removeClass("flipped")):(M.addClass("dropdown-flipped"),t(this).addClass("flipped")),t(this).css({left:e.left+"px",top:e.top+"px"})}}).width(M.width())};this.$=M,M[0].trivialTreeComboBox=this,this.updateEntries=v,this.getSelectedEntry=function(){if(null!=C||w.allowFreeText&&N.val()){if(null==C&&w.allowFreeText){var e=t.extend({},w.freeTextEntryValues);return e[w.inputTextProperty]=N.val(),e}var n=jQuery.extend({},C);return n._trEntryElement=void 0,n}return null},this.updateChildren=T.updateChildren,this.updateNode=T.updateNode,this.removeNode=T.removeNode}var i=e.keyCodes;return e.registerJqueryPlugin(r,"TrivialTreeComboBox","tr-combobox"),t.fn.TrivialTreeComboBox}),function(e){"use strict";"function"==typeof define&&define.amd?define("trivial-unitbox",["trivial-core","jquery","mustache"],e):"object"==typeof exports?module.exports=e(require("trivial-core"),require("jquery"),require("mustache")):jQuery&&!jQuery.fn.trivialunitbox&&e(TrivialComponents,jQuery,Mustache)}(function(e,t,n){function r(r,a){function o(e){var n=t(m.spinnerTemplate).appendTo(L);q=q.add(n),setTimeout(function(){m.queryFunction(N(),function(t){g(t);var n=N();n.length>0?(v.highlightTextMatches(n),v.highlightNextMatchingEntry(e)):v.highlightNextEntry(e),h(m.autoCompleteDelay),x&&u()})})}function l(){k.trigger("change"),O.trigger("change")}function s(e,r){if(null==e){T=null;var i=t(n.render(m.selectedEntryTemplate,m.emptyEntry)).addClass("tr-combobox-entry").addClass("empty");F.empty().append(i)}else{T=e;var i=t(n.render(m.selectedEntryTemplate,e)).addClass("tr-combobox-entry");F.empty().append(i)}d(),r||l()}function d(){var e=/[\d\.]+/.exec(M.val());e?M.val(M.val().substr(e.index,e[0].length)):M.val("")}function u(){O.addClass("open"),L.show().position({my:"left top",at:"left bottom",of:O,collision:"flip",using:function(e,n){"top"===n.vertical?(O.removeClass("dropdown-flipped"),t(this).removeClass("flipped")):(O.addClass("dropdown-flipped"),t(this).addClass("flipped")),t(this).css({left:e.left+"px",top:e.top+"px"})}}).width(O.width()),x=!0}function c(){O.removeClass("open"),L.hide(),x=!1}function p(){return M[0].selectionStart<M[0].selectionEnd&&M[0].selectionEnd===M.val().length?M.val().substring(0,M[0].selectionStart):M.val()}function h(e){if(m.autoComplete){clearTimeout(b);var t=v.getHighlightedEntry();if(t&&!C){var n=t[m.inputTextProperty];b=setTimeout(function(){var e,t=p(),r=N();e=0===n.toLowerCase().indexOf(r.toLowerCase())?t+n.substr(r.length):p(),M.val(e),setTimeout(function(){M[0].setSelectionRange(t.length,e.length)},0)},e||0)}C=!1}}function f(){var e=M.val().match(P);return e&&e[0]}function y(e){s(w.filter(function(t){return t[m.idProperty]===e})[0],!0)}function g(e){w=e,q.remove(),q=t(),v.updateEntries(e)}a=a||{};var m=t.extend({unitValueProperty:"code",idProperty:"code",decimalSeparator:".",decimalPrecision:2,unitDisplayPosition:"right",inputTextProperty:"code",template:e.currency2LineTemplate,selectedEntryTemplate:e.currencySingleLineShortTemplate,selectedEntry:void 0,spinnerTemplate:e.defaultSpinnerTemplate,noEntriesTemplate:e.defaultNoEntriesTemplate,entries:null,emptyEntry:{code:"..."},queryFunction:null,queryOnNonNumberFields:!0,openDropdownOnEditorClick:!1,autoComplete:!0,autoCompleteDelay:0,showTrigger:!0,matchingOptions:{matchingMode:"prefix-word",ignoreCase:!0,maxLevenshteinDistance:2}},a);m.queryFunction=m.queryFunction||e.defaultListQueryFunctionFactory(m.entries||[],m.matchingOptions);var v,x=!1,w=m.entries,T=null,E=!1,b=-1,C=!1,P=new RegExp("\\d+(?:\\"+m.decimalSeparator+"\\d*)?"),S=new RegExp("[^\\d\\"+m.decimalSeparator+" ]"),_=new RegExp("[^\\d\\"+m.decimalSeparator+" ](?=[\\d\\"+m.decimalSeparator+" ]*$)"),q=t(),k=t(r).addClass("tr-original-input"),M=t('<input type="text"/>'),O=t('<div class="tr-unitbox tr-input-wrapper"/>').insertAfter(k).addClass("left"===m.unitDisplayPosition?"unit-display-left":"unit-display-right");k.appendTo(O);var j=t('<div class="tr-unitbox-selected-entry-and-trigger-wrapper"/>').appendTo(O),F=t('<div class="tr-unitbox-selected-entry-wrapper"/>').appendTo(j);if(m.showTrigger){t('<div class="tr-trigger"><span class="tr-trigger-icon"/></div>').appendTo(j)}j.mousedown(function(){x?c():setTimeout(function(){u(),o()}),M.focus()});var L=t('<div class="tr-dropdown"></div>').appendTo("body");M.prependTo(O).addClass("tr-unitbox-editor tr-editor").focus(function(){E||O.addClass("focus")}).blur(function(){E?M.focus():(O.removeClass("focus"),d(),c())}).keydown(function(t){if(t.which!=i.tab&&!e.isModifierKey(t)&&t.which!=i.left_arrow&&t.which!=i.right_arrow){if((t.which==i.backspace||t.which==i["delete"])&&(C=!0),t.which==i.up_arrow||t.which==i.down_arrow){var n=t.which==i.up_arrow?-1:1;return x?(v.highlightNextEntry(n),h(m.autoCompleteDelay)):(u(),o(n)),!1}if(x&&t.which==i.enter)s(v.getHighlightedEntry()),c();else if(t.which==i.escape)c(),d();else if(!t.shiftKey&&-1!=i.numberKeys.indexOf(t.which)){var r=Q(),a=r.indexOf(m.decimalSeparator);if(-1!=a&&r.length-(a+1)>=m.decimalPrecision)return!1}}}).keypress(function(e){String.fromCharCode(e.which)}).keyup(function(e){-1!=i.specialKeys.indexOf(e.which)&&e.which!=i.backspace&&e.which!=i["delete"]||(N().length>0&&m.queryOnNonNumberFields?(u(),o(1)):c())}).mousedown(function(){m.openDropdownOnEditorClick&&(u(),null==w&&o())}).change(function(){D(),l()}),O.add(L).mousedown(function(){M.is(":focus")&&(E=!0)}).mouseup(function(){E&&(M.focus(),E=!1)}).mouseout(function(){E&&(M.focus(),E=!1)}),v=L.TrivialListBox(m),v.$.change(function(){var e=v.getSelectedEntry();e&&(s(e,!0),v.selectEntry(null),D(),c(),l())}),s(m.selectedEntry||null);var N=function(){var e=p(),t=e.search(S),n=e.search(_);return-1!=t?e.substring(t,n+1):""},Q=function(){var e=P.exec(M.val());return e?e[0]:""},D=function(){"left"===m.unitDisplayPosition?k.val((T?T[m.unitValueProperty]:"")+" "+f()):k.val(f()+" "+(T?T[m.unitValueProperty]:""))};this.$=O,O[0].trivialUnitBox=this,this.updateEntries=g,this.getSelectedUnit=function(){if(null==T)return null;var e=jQuery.extend({},T);return e._trEntryElement=void 0,e},this.getAmount=f,this.setAmount=function(e){M.val(e)},this.selectEntry=s,this.selectUnit=y}var i=e.keyCodes;return e.registerJqueryPlugin(r,"TrivialUnitBox","tr-unitbox"),t.fn.TrivialUnitBox});